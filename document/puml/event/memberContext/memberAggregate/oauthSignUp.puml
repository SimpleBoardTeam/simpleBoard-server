@startuml
actor User
participant AuthController
participant AuthService
participant OAuth2AuthenticationPrincipal
participant AuthRepository
participant AuthCredential
participant MemberService
participant MemberRepository
participant Member

User -> AuthController : POST /auth/email/signup { nickname } (Authorization: Bearer ACCESS_TOKEN)
AuthController -> OAuth2AuthenticationPrincipal : extractPrincipal()
OAuth2AuthenticationPrincipal --> AuthController : authUserId

AuthController -> AuthService : completeSignUp(authUserId, nickname)

AuthService -> AuthRepository : findById(authUserId)
AuthRepository -> AuthService : AuthCredential

AuthService -> MemberService : createMember(nickname)
MemberService -> Member : Member.create(nickname)
MemberService -> MemberRepository : save(member)

AuthService -> AuthCredential : linkTo(member.id)
AuthService -> AuthRepository : save(authCredential)

AuthService -> AuthController : 가입 완료 응답
AuthController --> User : HTTP 201 Created
@enduml